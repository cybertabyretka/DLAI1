# DLAI1
## Домашнее задание к уроку 1: Основы PyTorch
### Задание 1: Создание и манипуляции с тензорами (25 баллов)
1. Потренировался в создании тензоров, операциях с ними. 
2. Разобрался в том, как в них работает индексация.
3. Научился преобразовывать тензоры в разные формы.
### Задание 2: Автоматическое дифференцирование
1. Изучил функции и алгоритм автоматического подсчёта градиента функции.
### Задание 3: Сравнение производительности CPU vs CUDA
1. Сравнил производительность различных операций, выполненных на CPU и GPU. Получил следующие результаты:  

|Операция                             | Размер тензора       | CPU (мс)     | GPU (мс)     | Ускорение   |
|-------------------------------------|----------------------|--------------|--------------|-------------|
|Матричное умножение                  | 67108864             | 653.53       | 96.44        | 6.78        |
|Матричное умножение                  | 33554432             | 158.00       | 20.98        | 7.53        |
|Матричное умножение                  | 16777216             | 46.00        | 5.38         | 8.56        |
|Поэлементное сложение                | 67108864             | 79.00        | 7.10         | 11.12       |
|Поэлементное сложение                | 33554432             | 44.00        | 1.63         | 27.05       |
|Поэлементное сложение                | 16777216             | 22.00        | 0.85         | 25.76       |
|Поэлементное умножение               | 67108864             | 79.00        | 3.68         | 21.49       |
|Поэлементное умножение               | 33554432             | 38.00        | 1.62         | 23.40       |
|Поэлементное умножение               | 16777216             | 19.00        | 0.85         | 22.35       |
|Транспонирование                     | 67108864             | 0.00         | 0.00         | 0.00        |
|Транспонирование                     | 33554432             | 0.00         | 0.00         | 0.00        |
|Транспонирование                     | 16777216             | 0.00         | 0.00         | 0.00        |
|Вычисление суммы всех элементов      | 67108864             | 26.01        | 3.41         | 7.63        |
|Вычисление суммы всех элементов      | 33554432             | 9.00         | 0.81         | 11.16       |
|Вычисление суммы всех элементов      | 16777216             | 5.01         | 0.46         | 10.91       |


**Анализ результатов**

1. **Наибольшее ускорение на GPU**  
   Наибольшее ускорение наблюдается для следующих операций:  
   - Поэлементное умножение  
   - Вычисление суммы всех элементов  

   Это говорит о том, что данные операции хорошо распараллеливаются на GPU.

2. **Операции без ускорения**  
   Не было обнаружено операций, на которых производительность бы значительно ухудшалась.  
   Однако операция **транспонирования** показала нулевое ускорение, так как:  
   - Требует полного переупорядочивания данных в памяти  
   - Накладные расходы GPU превышают выгоду от параллелизации  

3. **Влияние размера матриц**  
   Размер матриц по-разному влияет на ускорение:  
   - Для **матричного умножения** и **поэлементного умножения**:  
     - Ускорение обратно пропорционально размеру тензора  
     - При малых размерах накладные расходы GPU нивелируют выгоду  
     - С ростом размерности влияние накладных расходов уменьшается
   - Для остальных операций ускорение практически константно

4. **Передача данных между CPU и GPU**  

   4.1 **Инициализация передачи данных**  
   - CPU подготавливает данные в оперативной памяти (RAM)  
   - GPU использует собственную память (VRAM), куда должны быть скопированы данные  

   4.2 **Способы передачи**  
   Дискретные GPU (NVIDIA, AMD) используют шину PCI Express:  

   | Версия PCIe  | Пропускная способность |  
   |--------------|------------------------|  
   | PCIe 3.0 x16 |               ~16 ГБ/с |  
   | PCIe 4.0 x16 |               ~32 ГБ/с |  
   | PCIe 5.0 x16 |               ~64 ГБ/с |  

   Данные копируются через DMA (прямой доступ к памяти)  

   4.3 **Роль драйверов и API**  
   - Драйвер GPU управляет передачей данных  
   - API (CUDA, OpenCL и др.) предоставляют функции для:  
     - Выделения памяти (`cudaMalloc`, `clCreateBuffer`)  
     - Копирования данных (`cudaMemcpy`, `clEnqueueWriteBuffer`)  
     - Синхронизации  

   4.4 **Задержки и оптимизации**  
   - Основная задержка: передача через PCIe (~микросекунды)  
   - Методы оптимизации:  
     - Пакетная передача (уменьшение вызовов API)  
     - Асинхронные копии (передача параллельно с вычислениями)  
     - Использование общей памяти 
     - Сжатие данных  